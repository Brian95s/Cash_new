// Importar módulos const express = require('express'); const mongoose = require('mongoose'); const bcrypt = require('bcrypt'); const jwt = require('jsonwebtoken'); const cors = require('cors');

// Configuración const app = express(); const PORT = 3000; const SECRET_KEY = 'tu_clave_secreta';

app.use(express.json()); app.use(cors());

// Conectar a MongoDB mongoose.connect('mongodb://localhost:27017/cashnew', { useNewUrlParser: true, useUnifiedTopology: true }).then(() => console.log('Conectado a MongoDB')).catch(err => console.error(err));

// Modelo de usuario const UserSchema = new mongoose.Schema({ email: String, password: String }); const User = mongoose.model('User', UserSchema);

// Registro de usuario app.post('/register', async (req, res) => { const { email, password } = req.body; const hashedPassword = await bcrypt.hash(password, 10); const user = new User({ email, password: hashedPassword }); await user.save(); res.json({ message: 'Usuario registrado' }); });

// Inicio de sesión app.post('/login', async (req, res) => { const { email, password } = req.body; const user = await User.findOne({ email }); if (!user) return res.status(400).json({ message: 'Usuario no encontrado' });

const isValid = await bcrypt.compare(password, user.password);
if (!isValid) return res.status(400).json({ message: 'Contraseña incorrecta' });

const token = jwt.sign({ email: user.email }, SECRET_KEY, { expiresIn: '1h' });
res.json({ message: 'Inicio de sesión exitoso', token });

});

app.listen(PORT, () => console.log(Servidor corriendo en http://localhost:${PORT}));
